#
#  2021/06/01 Yamashita
#
from matplotlib.colors import LinearSegmentedColormap

#from mpl_toolkits.basemap import cm
#cmap = cm.s3pcpn_l  # 色テーブルの選択
# 色テーブルの設定 (basemap cmのs3pcpn_l_dataのコードを利用）
_s3pcpn_l_data = {
    'blue': [(0.0, 1.0, 1.0),
             (0.050000000000000003, 0.81568628549575806, 0.81568628549575806),
             (0.10000000000000001, 1.0, 1.0),
             (0.14999999999999999, 0.50196081399917603, 0.50196081399917603),
             (0.20000000000000001, 0.0, 0.0), (0.25, 0.0, 0.0),
             (0.29999999999999999, 0.0, 0.0), (0.34999999999999998, 0.0, 0.0),
             (0.40000000000000002, 0.0, 0.0),
             (0.45000000000000001, 0.50196081399917603, 0.50196081399917603),
             (0.5, 1.0, 1.0), (0.55000000000000004, 1.0, 1.0),
             (0.59999999999999998, 1.0, 1.0),
             (0.65000000000000002, 0.50196081399917603, 0.50196081399917603),
             (0.69999999999999996, 0.12549020349979401, 0.12549020349979401),
             (0.75, 0.50196081399917603, 0.50196081399917603),
             (0.80000000000000004, 0.87843137979507446, 0.87843137979507446),
             (0.84999999999999998, 0.73725491762161255, 0.73725491762161255),
             (0.90000000000000002, 0.47058823704719543, 0.47058823704719543),
             (0.94999999999999996, 0.23529411852359772, 0.23529411852359772),
             (1.0, 0.0, 0.0)],
    'green': [(0.0, 1.0, 1.0),
              (0.050000000000000003, 0.81568628549575806, 0.81568628549575806),
              (0.10000000000000001, 1.0, 1.0),
              (0.14999999999999999, 0.87843137979507446, 0.87843137979507446),
              (0.20000000000000001, 0.75294119119644165, 0.75294119119644165),
              (0.25, 0.87843137979507446, 0.87843137979507446),
              (0.29999999999999999, 1.0, 1.0),
              (0.34999999999999998, 0.62745100259780884, 0.62745100259780884),
              (0.40000000000000002, 0.0, 0.0),
              (0.45000000000000001, 0.12549020349979401, 0.12549020349979401),
              (0.5, 0.25098040699958801, 0.25098040699958801),
              (0.55000000000000004, 0.12549020349979401, 0.12549020349979401),
              (0.59999999999999998, 0.25098040699958801, 0.25098040699958801),
              (0.65000000000000002, 0.12549020349979401, 0.12549020349979401),
              (0.69999999999999996, 0.12549020349979401, 0.12549020349979401),
              (0.75, 0.50196081399917603, 0.50196081399917603),
              (0.80000000000000004, 0.87843137979507446, 0.87843137979507446),
              (0.84999999999999998, 0.83137255907058716, 0.83137255907058716),
              (0.90000000000000002, 0.65098041296005249, 0.65098041296005249),
              (0.94999999999999996, 0.42352941632270813, 0.42352941632270813),
              (1.0, 0.20000000298023224, 0.20000000298023224)],
    'red': [(0.0, 1.0, 1.0),
            (0.050000000000000003, 0.31372550129890442, 0.31372550129890442),
            (0.10000000000000001, 0.0, 0.0), (0.14999999999999999, 0.0, 0.0),
            (0.20000000000000001, 0.0, 0.0),
            (0.25, 0.50196081399917603, 0.50196081399917603),
            (0.29999999999999999, 1.0, 1.0), (0.34999999999999998, 1.0, 1.0),
            (0.40000000000000002, 1.0, 1.0), (0.45000000000000001, 1.0, 1.0),
            (0.5, 0.94117647409439087, 0.94117647409439087),
            (0.55000000000000004, 0.50196081399917603, 0.50196081399917603),
            (0.59999999999999998, 0.25098040699958801, 0.25098040699958801),
            (0.65000000000000002, 0.12549020349979401, 0.12549020349979401),
            (0.69999999999999996, 0.12549020349979401, 0.12549020349979401),
            (0.75, 0.50196081399917603, 0.50196081399917603),
            (0.80000000000000004, 0.87843137979507446, 0.87843137979507446),
            (0.84999999999999998, 0.93333333730697632, 0.93333333730697632),
            (0.90000000000000002, 0.85490196943283081, 0.85490196943283081),
            (0.94999999999999996, 0.62745100259780884, 0.62745100259780884),
            (1.0, 0.40000000596046448, 0.40000000596046448)]
}

#from mpl_toolkits.basemap import cm
#cmap = cm.GMT_wysiwyg # 色テーブルの選択
# 色テーブルの設定 (basemap cmの_GMT_wysiwyg_dataのコードを利用）
_wysiwyg_data = {
    'blue': [(0.0, 0.250980407, 0.250980407),
             (0.0526315793395, 0.752941191196, 0.752941191196),
             (0.105263158679, 1.0, 1.0), (0.157894730568, 1.0, 1.0),
             (0.210526317358, 1.0, 1.0), (0.263157904148, 1.0, 1.0),
             (0.315789461136, 1.0, 1.0), (0.368421047926, 1.0, 1.0),
             (0.421052634716, 0.752941191196, 0.752941191196),
             (0.473684221506, 0.250980407, 0.250980407),
             (0.526315808296, 0.250980407, 0.250980407),
             (0.578947365284, 0.250980407, 0.250980407),
             (0.631578922272, 0.250980407, 0.250980407),
             (0.684210538864, 0.250980407, 0.250980407),
             (0.736842095852, 0.250980407, 0.250980407),
             (0.789473712444, 0.250980407, 0.250980407),
             (0.842105269432, 0.250980407, 0.250980407),
             (0.89473682642, 0.752941191196, 0.752941191196),
             (0.947368443012, 1.0, 1.0), (1.0, 1.0, 1.0)],
    'green': [(0.0, 0.0, 0.0), (0.0526315793395, 0.0, 0.0),
              (0.105263158679, 0.250980407, 0.250980407),
              (0.157894730568, 0.501960813999, 0.501960813999),
              (0.210526317358, 0.627451002598, 0.627451002598),
              (0.263157904148, 0.752941191196, 0.752941191196),
              (0.315789461136, 0.878431379795, 0.878431379795),
              (0.368421047926, 1.0, 1.0), (0.421052634716, 1.0, 1.0),
              (0.473684221506, 1.0, 1.0), (0.526315808296, 1.0, 1.0),
              (0.578947365284, 1.0, 1.0), (0.631578922272, 1.0, 1.0),
              (0.684210538864, 0.878431379795, 0.878431379795),
              (0.736842095852, 0.627451002598, 0.627451002598),
              (0.789473712444, 0.376470595598, 0.376470595598),
              (0.842105269432, 0.1254902035, 0.1254902035),
              (0.89473682642, 0.376470595598, 0.376470595598),
              (0.947368443012, 0.627451002598, 0.627451002598),
              (1.0, 0.878431379795, 0.878431379795)],
    'red': [(0.0, 0.250980407, 0.250980407),
            (0.0526315793395, 0.250980407, 0.250980407),
            (0.105263158679, 0.0, 0.0), (0.157894730568, 0.0, 0.0),
            (0.210526317358, 0.0, 0.0),
            (0.263157904148, 0.250980407, 0.250980407),
            (0.315789461136, 0.250980407, 0.250980407),
            (0.368421047926, 0.250980407, 0.250980407),
            (0.421052634716, 0.250980407, 0.250980407),
            (0.473684221506, 0.250980407, 0.250980407),
            (0.526315808296, 0.501960813999, 0.501960813999),
            (0.578947365284, 0.752941191196, 0.752941191196),
            (0.631578922272, 1.0, 1.0), (0.684210538864, 1.0, 1.0),
            (0.736842095852, 1.0, 1.0), (0.789473712444, 1.0, 1.0),
            (0.842105269432, 1.0, 1.0), (0.89473682642, 1.0, 1.0),
            (0.947368443012, 1.0, 1.0), (1.0, 1.0, 1.0)]
}

#from mpl_toolkits.basemap import cm
#cmap = cm.GMT_haxby# 色テーブルの選択
# 色テーブルの設定 (basemap cmの_GMT_haxby_dataのコードを利用）
_haxby_data = {
    'blue': [(0.0, 0.474509805441, 0.474509805441),
             (0.0322580635548, 0.588235318661, 0.588235318661),
             (0.0645161271095, 0.686274528503, 0.686274528503),
             (0.0967741906643, 0.784313738346, 0.784313738346),
             (0.129032254219, 0.831372559071, 0.831372559071),
             (0.161290317774, 0.878431379795, 0.878431379795),
             (0.193548381329, 0.941176474094, 0.941176474094),
             (0.225806444883, 0.972549021244, 0.972549021244),
             (0.258064508438, 1.0, 1.0), (0.290322571993, 1.0, 1.0),
             (0.322580635548, 1.0, 1.0),
             (0.354838699102, 0.941176474094, 0.941176474094),
             (0.387096762657, 0.882352948189, 0.882352948189),
             (0.419354826212, 0.784313738346, 0.784313738346),
             (0.451612889767, 0.68235296011, 0.68235296011),
             (0.483870953321, 0.658823549747, 0.658823549747),
             (0.516129016876, 0.635294139385, 0.635294139385),
             (0.548387110233, 0.552941203117, 0.552941203117),
             (0.580645143986, 0.474509805441, 0.474509805441),
             (0.612903237343, 0.407843142748, 0.407843142748),
             (0.645161271095, 0.341176480055, 0.341176480055),
             (0.677419364452, 0.270588248968, 0.270588248968),
             (0.709677398205, 0.29411765933, 0.29411765933),
             (0.741935491562, 0.305882364511, 0.305882364511),
             (0.774193525314, 0.352941185236, 0.352941185236),
             (0.806451618671, 0.486274510622, 0.486274510622),
             (0.838709652424, 0.61960786581, 0.61960786581),
             (0.870967745781, 0.68235296011, 0.68235296011),
             (0.903225779533, 0.768627464771, 0.768627464771),
             (0.93548387289, 0.843137264252, 0.843137264252),
             (0.967741906643, 0.921568632126, 0.921568632126),
             (1.0, 1.0, 1.0)],
    'green': [(0.0, 0.0, 0.0), (0.0322580635548, 0.0, 0.0),
              (0.0645161271095, 0.0196078438312, 0.0196078438312),
              (0.0967741906643, 0.0392156876624, 0.0392156876624),
              (0.129032254219, 0.0980392172933, 0.0980392172933),
              (0.161290317774, 0.156862750649, 0.156862750649),
              (0.193548381329, 0.40000000596, 0.40000000596),
              (0.225806444883, 0.505882382393, 0.505882382393),
              (0.258064508438, 0.686274528503, 0.686274528503),
              (0.290322571993, 0.745098054409, 0.745098054409),
              (0.322580635548, 0.792156875134, 0.792156875134),
              (0.354838699102, 0.882352948189, 0.882352948189),
              (0.387096762657, 0.921568632126, 0.921568632126),
              (0.419354826212, 0.921568632126, 0.921568632126),
              (0.451612889767, 0.92549020052, 0.92549020052),
              (0.483870953321, 0.960784316063, 0.960784316063),
              (0.516129016876, 1.0, 1.0),
              (0.548387110233, 0.960784316063, 0.960784316063),
              (0.580645143986, 0.92549020052, 0.92549020052),
              (0.612903237343, 0.843137264252, 0.843137264252),
              (0.645161271095, 0.741176486015, 0.741176486015),
              (0.677419364452, 0.627451002598, 0.627451002598),
              (0.709677398205, 0.458823531866, 0.458823531866),
              (0.741935491562, 0.313725501299, 0.313725501299),
              (0.774193525314, 0.352941185236, 0.352941185236),
              (0.806451618671, 0.486274510622, 0.486274510622),
              (0.838709652424, 0.61960786581, 0.61960786581),
              (0.870967745781, 0.701960802078, 0.701960802078),
              (0.903225779533, 0.768627464771, 0.768627464771),
              (0.93548387289, 0.843137264252, 0.843137264252),
              (0.967741906643, 0.921568632126, 0.921568632126),
              (1.0, 1.0, 1.0)],
    'red': [(0.0, 0.0392156876624, 0.0392156876624),
            (0.0322580635548, 0.156862750649, 0.156862750649),
            (0.0645161271095, 0.0784313753247, 0.0784313753247),
            (0.0967741906643, 0.0, 0.0), (0.129032254219, 0.0, 0.0),
            (0.161290317774, 0.0, 0.0),
            (0.193548381329, 0.101960785687, 0.101960785687),
            (0.225806444883, 0.0509803928435, 0.0509803928435),
            (0.258064508438, 0.0980392172933, 0.0980392172933),
            (0.290322571993, 0.196078434587, 0.196078434587),
            (0.322580635548, 0.266666680574, 0.266666680574),
            (0.354838699102, 0.380392163992, 0.380392163992),
            (0.387096762657, 0.415686279535, 0.415686279535),
            (0.419354826212, 0.486274510622, 0.486274510622),
            (0.451612889767, 0.541176497936, 0.541176497936),
            (0.483870953321, 0.674509823322, 0.674509823322),
            (0.516129016876, 0.803921580315, 0.803921580315),
            (0.548387110233, 0.874509811401, 0.874509811401),
            (0.580645143986, 0.941176474094, 0.941176474094),
            (0.612903237343, 0.96862745285, 0.96862745285),
            (0.645161271095, 1.0, 1.0), (0.677419364452, 1.0, 1.0),
            (0.709677398205, 0.956862747669, 0.956862747669),
            (0.741935491562, 0.933333337307, 0.933333337307),
            (0.774193525314, 1.0, 1.0), (0.806451618671, 1.0, 1.0),
            (0.838709652424, 1.0, 1.0),
            (0.870967745781, 0.960784316063, 0.960784316063),
            (0.903225779533, 1.0, 1.0), (0.93548387289, 1.0, 1.0),
            (0.967741906643, 1.0, 1.0), (1.0, 1.0, 1.0)]
}

#from mpl_toolkits.basemap import cm
#cmap = cm.GMT_wysiwyg # 色テーブルの選択
# 色テーブルの設定 (basemap cmの_GMT_drywet_dataのコードを利用）
_drywet_data = {
    'blue': [(0.0, 0.164705887437, 0.164705887437),
             (0.20000000298, 0.392156869173, 0.392156869173),
             (0.40000000596, 0.529411792755, 0.529411792755),
             (0.600000023842, 0.921568632126, 0.921568632126),
             (0.800000011921, 0.933333337307, 0.933333337307),
             (1.0, 0.717647075653, 0.717647075653)],
    'green': [(0.0, 0.380392163992, 0.380392163992),
              (0.20000000298, 0.780392169952, 0.780392169952),
              (0.40000000596, 0.933333337307, 0.933333337307),
              (0.600000023842, 0.933333337307, 0.933333337307),
              (0.800000011921, 0.470588237047, 0.470588237047),
              (1.0, 0.00392156885937, 0.00392156885937)],
    'red': [(0.0, 0.525490224361, 0.525490224361),
            (0.20000000298, 0.933333337307, 0.933333337307),
            (0.40000000596, 0.705882370472, 0.705882370472),
            (0.600000023842, 0.196078434587, 0.196078434587),
            (0.800000011921, 0.0470588244498, 0.0470588244498),
            (1.0, 0.149019613862, 0.149019613862)]
}

#from mpl_toolkits.basemap import cm
#cmap = cm.GMT_no_green # 色テーブルの選択
# 色テーブルの設定 (basemap cmの_GMT_no_green_dataのコードを利用）
_no_green_data = {
    'blue': [(0.0, 1.0, 1.0), (0.0666666701436, 1.0, 1.0),
             (0.133333340287, 1.0, 1.0), (0.20000000298, 1.0, 1.0),
             (0.266666680574, 1.0, 1.0), (0.333333343267, 1.0, 1.0),
             (0.40000000596, 1.0, 1.0), (0.466666668653, 1.0, 1.0),
             (0.533333361149, 0.329411774874, 0.329411774874),
             (0.600000023842, 0.0, 0.0), (0.666666686535, 0.0, 0.0),
             (0.733333349228, 0.0, 0.0), (0.800000011921, 0.0, 0.0),
             (0.866666674614, 0.0, 0.0), (0.933333337307, 0.0, 0.0),
             (1.0, 0.0, 0.0)],
    'green': [(0.0, 0.376470595598, 0.376470595598),
              (0.0666666701436, 0.623529434204, 0.623529434204),
              (0.133333340287, 0.749019622803, 0.749019622803),
              (0.20000000298, 0.811764717102, 0.811764717102),
              (0.266666680574, 1.0, 1.0), (0.333333343267, 1.0, 1.0),
              (0.40000000596, 1.0, 1.0), (0.466666668653, 1.0, 1.0),
              (0.533333361149, 1.0, 1.0),
              (0.600000023842, 0.941176474094, 0.941176474094),
              (0.666666686535, 0.749019622803, 0.749019622803),
              (0.733333349228, 0.658823549747, 0.658823549747),
              (0.800000011921, 0.541176497936, 0.541176497936),
              (0.866666674614, 0.439215689898, 0.439215689898),
              (0.933333337307, 0.301960796118, 0.301960796118),
              (1.0, 0.0, 0.0)],
    'red': [(0.0, 0.1254902035, 0.1254902035),
            (0.0666666701436, 0.1254902035, 0.1254902035),
            (0.133333340287, 0.1254902035, 0.1254902035),
            (0.20000000298, 0.0, 0.0),
            (0.266666680574, 0.164705887437, 0.164705887437),
            (0.333333343267, 0.333333343267, 0.333333343267),
            (0.40000000596, 0.498039215803, 0.498039215803),
            (0.466666668653, 0.666666686535, 0.666666686535),
            (0.533333361149, 1.0, 1.0), (0.600000023842, 1.0, 1.0),
            (0.666666686535, 1.0, 1.0), (0.733333349228, 1.0, 1.0),
            (0.800000011921, 1.0, 1.0), (0.866666674614, 1.0, 1.0),
            (0.933333337307, 1.0, 1.0), (1.0, 1.0, 1.0)]
}


# ColUtils: カラーユーティリティ
class ColUtils():
    def __init__(self, cmap_name=None):
        self.cmap_name = cmap_name
        if self.cmap_name == "s3pcpn_l":
            self._segment_data = _s3pcpn_l_data
        elif self.cmap_name == "wysiwyg":
            self._segment_data = _wysiwyg_data
        elif self.cmap_name == "haxby":
            self._segment_data = _haxby_data
        elif self.cmap_name == "drywet":
            self._segment_data = _drywet_data
        elif self.cmap_name == "no_green":
            self._segment_data = _no_green_data
        else:
            raise Exception("invalid cmap_name")

    def get_ctable(self, under=None, over=None):
        # カラーマップ作成
        cmap = LinearSegmentedColormap('colormap_name', self._segment_data)
        if under is not None:
            cmap.set_under(under)  # 下限を下回った場合の色を指定
        if over is not None:
            cmap.set_over(over)  # 上限を超えた場合の色を指定
        return cmap
